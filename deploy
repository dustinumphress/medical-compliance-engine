#!/bin/bash

# 1. Ask for the Image URI
echo "--------------------------------------------------"
echo "üöÄ Medical Audit Demo - Deployment Launcher"
echo "--------------------------------------------------"
read -p "Paste your full ECR Image URI: " IMAGE_URI

# 2. Check if user actually typed something
if [ -z "$IMAGE_URI" ]; then
    echo "‚ùå Error: Image URI cannot be empty."
    exit 1
fi

echo "--------------------------------------------------"
echo "üì¶ Deploying image: $IMAGE_URI"
echo "--------------------------------------------------"

# 3. Run the AWS Command using the variable
aws cloudformation deploy \
  --template-file serverless_deploy.yaml \
  --stack-name MedicalDemoStack \
  --parameter-overrides ImageUri="$IMAGE_URI" \
  --capabilities CAPABILITY_NAMED_IAM

echo "‚úÖ Deployment Complete!"